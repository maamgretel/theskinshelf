<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mobile Navigation - Usage Examples</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Poppins', sans-serif;
            padding-top: 70px; 
            background-color: #f8f9fa;
        }
        
        .demo-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.375rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        
        .highlight {
            background: #ffd700;
            color: #000;
            padding: 2px 4px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <!-- Standard Header -->
    <header class="p-3 mb-3 border-bottom bg-white shadow-sm fixed-top">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between">
                <a href="#" class="navbar-brand text-dark text-decoration-none">
                    <strong>TheSkinShelf</strong>
                </a>
                
                <form class="flex-grow-1 mx-3">
                    <input type="search" class="form-control" placeholder="Search..." style="border-radius: 20px;">
                </form>
                
                <!-- Desktop Navigation -->
                <div class="desktop-nav-items d-flex align-items-center">
                    <a href="#" class="nav-link px-2 text-dark position-relative">
                        <i class="fas fa-shopping-bag fa-lg"></i>
                        <span id="cart-badge" class="badge badge-danger" style="position: absolute; top: 0; right: 0;">3</span>
                    </a>
                    <a href="#" class="nav-link px-2 text-dark position-relative">
                        <i class="fas fa-bell fa-lg"></i>
                        <span id="notifBadge" class="badge badge-danger" style="position: absolute; top: 0; right: 0;">2</span>
                    </a>
                    <a href="#" class="nav-link px-2 text-dark">
                        <i class="fas fa-user-circle fa-lg"></i>
                    </a>
                    <a href="#" class="nav-link px-2 text-dark">
                        <i class="fas fa-sign-out-alt fa-lg"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <h1 class="mb-4">Mobile Navigation Component</h1>
        
        <div class="demo-section">
            <h3>üì± Features</h3>
            <ul class="list-unstyled">
                <li><i class="fas fa-check text-success mr-2"></i> Responsive bottom navigation for mobile devices</li>
                <li><i class="fas fa-check text-success mr-2"></i> Automatic device detection</li>
                <li><i class="fas fa-check text-success mr-2"></i> Badge synchronization between header and mobile nav</li>
                <li><i class="fas fa-check text-success mr-2"></i> Active state management</li>
                <li><i class="fas fa-check text-success mr-2"></i> Cordova/PhoneGap support</li>
                <li><i class="fas fa-check text-success mr-2"></i> Safe area support for notched devices</li>
                <li><i class="fas fa-check text-success mr-2"></i> Hardware back button handling</li>
            </ul>
        </div>

        <div class="demo-section">
            <h3>üöÄ Quick Start</h3>
            <p>1. Include the mobile navigation script in your HTML:</p>
            <div class="code-block">
&lt;script src="js/mobile-nav.js"&gt;&lt;/script&gt;
            </div>
            
            <p class="mt-3">2. The navigation will auto-initialize, or you can manually initialize:</p>
            <div class="code-block">
// Auto-initialization (recommended)
// Just include the script and it works!

// Manual initialization
const mobileNav = new MobileNavigation({
    activeRoute: 'home',
    cartBadgeId: 'cart-badge',
    notifBadgeId: 'notifBadge'
});
            </div>
        </div>

        <div class="demo-section">
            <h3>‚öôÔ∏è Configuration Options</h3>
            <div class="code-block">
const options = {
    activeRoute: 'home',                    // Current page identifier
    cartBadgeId: 'cart-badge',             // Cart badge element ID
    notifBadgeId: 'notifBadge',            // Notification badge element ID
    showOrdersInHeader: true,               // Show orders icon in mobile header
    customNavItems: [                       // Custom navigation items
        {
            href: 'home.html',
            icon: 'fas fa-home',
            label: 'Home',
            key: 'home',
            active: ['home', 'dashboard']
        }
        // ... more items
    ]
};

const mobileNav = new MobileNavigation(options);
            </div>
        </div>

        <div class="demo-section">
            <h3>üìÑ Page Implementation Examples</h3>
            
            <h5 class="mt-4">Customer Dashboard (Home)</h5>
            <div class="code-block">
&lt;!-- Include in your HTML head --&gt;
&lt;script src="js/mobile-nav.js"&gt;&lt;/script&gt;

&lt;script&gt;
// Page-specific initialization (optional)
document.addEventListener('DOMContentLoaded', function() {
    window.mobileNav = new MobileNavigation({
        activeRoute: 'home',
        cartBadgeId: 'cart-badge',
        notifBadgeId: 'notifBadge'
    });
});
&lt;/script&gt;
            </div>

            <h5 class="mt-4">Shopping Bag Page</h5>
            <div class="code-block">
&lt;script&gt;
document.addEventListener('DOMContentLoaded', function() {
    window.mobileNav = new MobileNavigation({
        activeRoute: 'bag'
    });
});
&lt;/script&gt;
            </div>

            <h5 class="mt-4">Profile Page</h5>
            <div class="code-block">
&lt;script&gt;
document.addEventListener('DOMContentLoaded', function() {
    window.mobileNav = new MobileNavigation({
        activeRoute: 'profile',
        showOrdersInHeader: false  // Don't show orders icon on profile page
    });
});
&lt;/script&gt;
            </div>
        </div>

        <div class="demo-section">
            <h3>üîÑ Dynamic Badge Updates</h3>
            <div class="code-block">
// Update cart badge
mobileNav.updateCartBadge(5);

// Update notification badge
mobileNav.updateNotificationBadge(3);

// Remove badges (set to 0)
mobileNav.updateCartBadge(0);
mobileNav.updateNotificationBadge(0);
            </div>
            
            <div class="mt-3">
                <button class="btn btn-primary mr-2" onclick="updateCartDemo()">Update Cart Badge</button>
                <button class="btn btn-info mr-2" onclick="updateNotifDemo()">Update Notification Badge</button>
                <button class="btn btn-secondary" onclick="clearBadgesDemo()">Clear Badges</button>
            </div>
        </div>

        <div class="demo-section">
            <h3>üì± Mobile-Only Features</h3>
            <p class="text-muted">The following features are only visible on mobile devices (width ‚â§ 767px) or mobile user agents:</p>
            <ul>
                <li><strong>Bottom Navigation Bar:</strong> Replaces header navigation on mobile</li>
                <li><strong>Mobile Header Icons:</strong> Orders and profile icons in the header</li>
                <li><strong>Touch Optimizations:</strong> Proper touch targets and zoom prevention</li>
                <li><strong>Safe Area Support:</strong> Handles notched devices properly</li>
            </ul>
        </div>

        <div class="demo-section">
            <h3>üîß Advanced Usage</h3>
            <div class="code-block">
// Custom navigation items
const customNavItems = [
    { 
        href: 'dashboard.html', 
        icon: 'fas fa-home', 
        label: 'Home', 
        key: 'home',
        active: ['dashboard', 'home', 'index']
    },
    { 
        href: 'orders.html', 
        icon: 'fas fa-receipt', 
        label: 'Orders', 
        key: 'orders',
        active: ['orders', 'order-history']
    },
    { 
        href: 'favorites.html', 
        icon: 'fas fa-heart', 
        label: 'Favorites', 
        key: 'favorites',
        active: ['favorites', 'wishlist']
    },
    { 
        href: 'profile.html', 
        icon: 'fas fa-user', 
        label: 'Profile', 
        key: 'profile',
        active: ['profile', 'account']
    }
];

const mobileNav = new MobileNavigation({
    customNavItems: customNavItems
});

// Refresh navigation state
mobileNav.refresh();

// Destroy navigation
mobileNav.destroy();
            </div>
        </div>

        <div class="demo-section">
            <h3>üìã Cordova Integration</h3>
            <div class="code-block">
// The component automatically handles Cordova events
// No additional setup required!

// Custom back button handling (optional)
document.addEventListener('deviceready', function() {
    const mobileNav = new MobileNavigation({
        activeRoute: 'home'
    });
    
    // Override back button behavior
    mobileNav.handleBackButton = function() {
        // Your custom logic here
        navigator.notification.confirm(
            'Exit app?',
            function(buttonIndex) {
                if (buttonIndex === 1) {
                    navigator.app.exitApp();
                }
            },
            'Confirm Exit',
            ['Yes', 'No']
        );
    };
});
            </div>
        </div>

        <div class="alert alert-info">
            <i class="fas fa-info-circle mr-2"></i>
            <strong>Test on Mobile:</strong> To see the mobile navigation in action, resize your browser window to mobile size (‚â§ 767px) or open this page on a mobile device.
        </div>
    </div>

    <script>
        // Demo functions for badge updates
        let cartCount = 3;
        let notifCount = 2;

        function updateCartDemo() {
            cartCount++;
            if (window.mobileNav) {
                window.mobileNav.updateCartBadge(cartCount);
            }
            // Also update the header badge directly for demo
            const headerBadge = document.getElementById('cart-badge');
            if (headerBadge) {
                headerBadge.textContent = cartCount;
                headerBadge.style.display = 'block';
            }
        }

        function updateNotifDemo() {
            notifCount++;
            if (window.mobileNav) {
                window.mobileNav.updateNotificationBadge(notifCount);
            }
            // Also update the header badge directly for demo
            const headerBadge = document.getElementById('notifBadge');
            if (headerBadge) {
                headerBadge.textContent = notifCount;
                headerBadge.style.display = 'block';
            }
        }

        function clearBadgesDemo() {
            cartCount = 0;
            notifCount = 0;
            if (window.mobileNav) {
                window.mobileNav.updateCartBadge(0);
                window.mobileNav.updateNotificationBadge(0);
            }
            // Also update the header badges directly for demo
            const headerCartBadge = document.getElementById('cart-badge');
            const headerNotifBadge = document.getElementById('notifBadge');
            if (headerCartBadge) headerCartBadge.style.display = 'none';
            if (headerNotifBadge) headerNotifBadge.style.display = 'none';
        }
    </script>
    
    <!-- Include the mobile navigation component -->
    <script>
        // Inline the mobile navigation component for demo
        // In production, include it as a separate file
        
        class MobileNavigation {
            constructor(options = {}) {
                this.options = {
                    activeRoute: options.activeRoute || '',
                    cartBadgeId: options.cartBadgeId || 'cart-badge',
                    notifBadgeId: options.notifBadgeId || 'notifBadge',
                    showOrdersInHeader: options.showOrdersInHeader !== false,
                    customNavItems: options.customNavItems || null,
                    ...options
                };
                
                this.init();
            }

            isMobileDevice() {
                return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                       window.innerWidth <= 767;
            }

            generateMobileNav() {
                const navItems = this.options.customNavItems || [
                    { 
                        href: 'customer_dashboard.html', 
                        icon: 'fas fa-home', 
                        label: 'Home', 
                        key: 'home',
                        active: ['dashboard', 'home', 'index']
                    },
                    { 
                        href: 'bag.html', 
                        icon: 'fas fa-shopping-bag', 
                        label: 'Bag', 
                        key: 'bag',
                        badge: 'mobile-cart-badge',
                        active: ['bag', 'cart']
                    },
                    { 
                        href: 'notifications.html', 
                        icon: 'fas fa-bell', 
                        label: 'Notifications', 
                        key: 'notifications',
                        badge: 'mobile-notif-badge',
                        active: ['notifications', 'notif']
                    },
                    { 
                        href: 'profile.html', 
                        icon: 'fas fa-user-circle', 
                        label: 'Profile', 
                        key: 'profile',
                        active: ['profile', 'account']
                    }
                ];

                const navItemsHTML = navItems.map(item => {
                    const badgeHTML = item.badge ? 
                        `<span id="${item.badge}" class="badge badge-danger" style="display: none;"></span>` : '';
                    
                    return `
                        <li class="nav-item">
                            <a class="nav-link position-relative" href="${item.href}" data-nav-key="${item.key}">
                                <i class="${item.icon}"></i>
                                <span>${item.label}</span>
                                ${badgeHTML}
                            </a>
                        </li>
                    `;
                }).join('');

                return `
                    <nav class="mobile-bottom-nav">
                        <ul class="nav">
                            ${navItemsHTML}
                        </ul>
                    </nav>
                `;
            }

            generateMobileHeaderIcons() {
                if (!this.options.showOrdersInHeader) return '';
                
                return `
                    <div class="mobile-header-icons" style="display: none;">
                        <a href="orders.html" class="nav-link px-2 text-dark" title="My Orders">
                            <i class="fas fa-receipt"></i>
                        </a>
                        <a href="profile.html" class="nav-link px-2 text-dark">
                            <i class="fas fa-user-circle"></i>
                        </a>
                    </div>
                `;
            }

            addStyles() {
                if (document.getElementById('mobile-nav-styles')) return;
                
                const styles = `
                    <style id="mobile-nav-styles">
                        :root {
                            --bottom-nav-height: 70px;
                        }

                        .is-mobile {
                            padding-bottom: var(--bottom-nav-height) !important;
                        }

                        .mobile-bottom-nav {
                            display: none;
                            position: fixed;
                            bottom: 0;
                            left: 0;
                            right: 0;
                            background: #ffffff;
                            border-top: 1px solid #e9ecef;
                            height: var(--bottom-nav-height);
                            z-index: 1040;
                            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
                        }

                        .mobile-bottom-nav .nav {
                            height: 100%;
                            display: flex;
                            justify-content: space-around;
                            align-items: center;
                        }

                        .mobile-bottom-nav .nav-item {
                            flex: 1;
                            text-align: center;
                        }

                        .mobile-bottom-nav .nav-link {
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            height: 100%;
                            color: #6c757d;
                            text-decoration: none;
                            padding: 8px 4px;
                            font-size: 0.7rem;
                            transition: all 0.2s ease;
                            position: relative;
                        }

                        .mobile-bottom-nav .nav-link.active {
                            color: #007bff;
                            background-color: rgba(0, 123, 255, 0.05);
                        }

                        .mobile-bottom-nav .nav-link:hover {
                            color: #007bff;
                            text-decoration: none;
                        }

                        .mobile-bottom-nav .nav-link i {
                            font-size: 1.2rem;
                            margin-bottom: 2px;
                        }

                        .mobile-bottom-nav .nav-link .badge {
                            position: absolute;
                            top: 8px;
                            right: 50%;
                            transform: translateX(50%);
                            font-size: 0.6rem;
                            padding: 2px 5px;
                            border-radius: 10px;
                        }

                        .mobile-header-icons {
                            display: none !important;
                            align-items: center;
                            gap: 10px;
                        }

                        .mobile-header-icons .nav-link {
                            padding: 6px;
                            color: #343a40;
                            text-decoration: none;
                        }

                        @media (max-width: 767.98px) {
                            .mobile-bottom-nav {
                                display: block !important;
                            }

                            .desktop-nav-items {
                                display: none !important;
                            }

                            .mobile-header-icons {
                                display: flex !important;
                            }
                        }

                        @supports (padding: max(0px)) {
                            .mobile-bottom-nav {
                                padding-bottom: max(0px, env(safe-area-inset-bottom));
                            }
                        }
                    </style>
                `;
                
                document.head.insertAdjacentHTML('beforeend', styles);
            }

            init() {
                this.addStyles();
                
                const mobileNavHTML = this.generateMobileNav();
                document.body.insertAdjacentHTML('beforeend', mobileNavHTML);
                
                const headerContainer = document.querySelector('.fixed-top .container .d-flex');
                if (headerContainer && !document.querySelector('.mobile-header-icons')) {
                    const mobileHeaderHTML = this.generateMobileHeaderIcons();
                    headerContainer.insertAdjacentHTML('beforeend', mobileHeaderHTML);
                }
                
                this.initializeMobileFeatures();
                this.setupEventListeners();
            }

            initializeMobileFeatures() {
                if (this.isMobileDevice()) {
                    document.body.classList.add('is-mobile');
                    this.syncBadges();
                    this.updateActiveNavState();
                }
            }

            syncBadges() {
                this.syncCartBadges();
                this.syncNotificationBadges();
            }

            syncCartBadges() {
                const headerBadge = document.getElementById(this.options.cartBadgeId);
                const mobileBadge = document.getElementById('mobile-cart-badge');
                
                if (headerBadge && mobileBadge) {
                    if (headerBadge.style.display !== 'none' && headerBadge.textContent) {
                        mobileBadge.textContent = headerBadge.textContent;
                        mobileBadge.style.display = 'block';
                    } else {
                        mobileBadge.style.display = 'none';
                    }
                }
            }

            syncNotificationBadges() {
                const headerBadge = document.getElementById(this.options.notifBadgeId);
                const mobileBadge = document.getElementById('mobile-notif-badge');
                
                if (headerBadge && mobileBadge) {
                    if (headerBadge.style.display !== 'none' && headerBadge.textContent) {
                        mobileBadge.textContent = headerBadge.textContent;
                        mobileBadge.style.display = 'block';
                    } else {
                        mobileBadge.style.display = 'none';
                    }
                }
            }

            updateActiveNavState() {
                const currentPage = this.options.activeRoute || this.getCurrentPageFromPath();
                const navLinks = document.querySelectorAll('.mobile-bottom-nav .nav-link');
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    const navKey = link.getAttribute('data-nav-key');
                    
                    if (this.isCurrentPage(currentPage, navKey)) {
                        link.classList.add('active');
                    }
                });
            }

            getCurrentPageFromPath() {
                const path = window.location.pathname;
                const filename = path.split('/').pop().replace('.html', '');
                return filename || 'home';
            }

            isCurrentPage(currentPage, navKey) {
                const navItems = {
                    'home': ['dashboard', 'home', 'index', 'customer_dashboard'],
                    'bag': ['bag', 'cart', 'shopping'],
                    'notifications': ['notifications', 'notif'],
                    'profile': ['profile', 'account', 'settings']
                };

                const matchingPages = navItems[navKey] || [navKey];
                return matchingPages.some(page => 
                    currentPage.includes(page) || 
                    page.includes(currentPage)
                );
            }

            setupEventListeners() {
                window.addEventListener('resize', () => {
                    this.initializeMobileFeatures();
                });
                
                setInterval(() => {
                    if (this.isMobileDevice()) {
                        this.syncBadges();
                    }
                }, 1000);

                if (typeof window.cordova !== 'undefined') {
                    document.addEventListener('deviceready', () => {
                        console.log('Cordova device ready');
                        this.initializeMobileFeatures();
                        
                        document.addEventListener('backbutton', (e) => {
                            e.preventDefault();
                            this.handleBackButton();
                        }, false);
                    }, false);
                }

                document.addEventListener('touchstart', () => {
                    document.querySelectorAll('input, select, textarea').forEach(element => {
                        element.style.fontSize = '16px';
                    });
                });
            }

            handleBackButton() {
                const currentPage = this.getCurrentPageFromPath();
                
                if (currentPage === 'home' || currentPage === 'dashboard' || currentPage === 'customer_dashboard') {
                    if (navigator.app && navigator.app.exitApp) {
                        navigator.app.exitApp();
                    }
                } else {
                    window.location.href = 'customer_dashboard.html';
                }
            }

            updateCartBadge(count) {
                const headerBadge = document.getElementById(this.options.cartBadgeId);
                const mobileBadge = document.getElementById('mobile-cart-badge');
                
                [headerBadge, mobileBadge].forEach(badge => {
                    if (badge) {
                        if (count > 0) {
                            badge.textContent = count;
                            badge.style.display = 'block';
                        } else {
                            badge.style.display = 'none';
                        }
                    }
                });
            }

            updateNotificationBadge(count) {
                const headerBadge = document.getElementById(this.options.notifBadgeId);
                const mobileBadge = document.getElementById('mobile-notif-badge');
                
                [headerBadge, mobileBadge].forEach(badge => {
                    if (badge) {
                        if (count > 0) {
                            badge.textContent = count;
                            badge.style.display = 'block';
                        } else {
                            badge.style.display = 'none';
                        }
                    }
                });
            }

            refresh() {
                this.initializeMobileFeatures();
            }

            destroy() {
                const mobileNav = document.querySelector('.mobile-bottom-nav');
                const mobileHeaderIcons = document.querySelector('.mobile-header-icons');
                const styles = document.getElementById('mobile-nav-styles');
                
                if (mobileNav) mobileNav.remove();
                if (mobileHeaderIcons) mobileHeaderIcons.remove();
                if (styles) styles.remove();
                
                document.body.classList.remove('is-mobile');
            }
        }

        // Initialize the mobile navigation for this demo page
        document.addEventListener('DOMContentLoaded', function() {
            window.mobileNav = new MobileNavigation({
                activeRoute: 'home'
            });
        });
    </script>
</body>
</html>